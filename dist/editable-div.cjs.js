"use strict";const o=require("vue"),h=["contenteditable"],x=o.defineComponent({__name:"component",props:{canEdit:{type:Boolean,default:!0},limit:{default:99999},content:{},renderHtml:{type:Boolean,default:!1}},emits:["update:content","focus"],setup(f,{emit:p}){const l=f,a=p,i=o.ref(!1),c=o.ref(!1),r=o.ref(""),s=o.ref(),m=t=>{const e=s.value.textContent;i.value||(e.length>=l.limit?(t.preventDefault(),u(e)):(a("update:content",e),r.value=e))},v=t=>{const e=document.createRange();e.selectNodeContents(t),e.collapse(!1);const n=window.getSelection();n.removeAllRanges(),n.addRange(e),c.value=!0},d=t=>{t.type==="compositionstart"?i.value=!0:t.type==="compositionend"&&(i.value=!1)},u=t=>{let e;if(l.renderHtml){let n=document.createElement("div");n.style.display="none",n.innerHTML=t,e=n.innerText.slice(0,l.limit),s.value.innerHTML=t,n=null}else e=t.slice(0,l.limit),s.value.innerText=e;r.value=e,a("update:content",e),v(s.value)},C=()=>{c.value=!0,a("focus",!0)},g=()=>{c.value=!1,a("focus",!1)};return o.onMounted(()=>{s.value.addEventListener("paste",t=>{t.preventDefault();const e=t.clipboardData.getData("text/plain"),n=r.value+e;n.length>=l.limit?u(n):document.execCommand("insertText",!1,e)})}),o.watch(()=>l.content,t=>{if(!c){if(i)return;u(t)}}),(t,e)=>(o.openBlock(),o.createElementBlock("div",{ref_key:"editorContainer",ref:s,contenteditable:l.canEdit,onKeyup:m,onCompositionstart:d,onCompositionend:d,onFocus:C,onBlur:g},null,40,h))}});module.exports=x;
