(function(n,s){typeof exports=="object"&&typeof module<"u"?module.exports=s(require("vue-demi")):typeof define=="function"&&define.amd?define(["vue-demi"],s):(n=typeof globalThis<"u"?globalThis:n||self,n["editable-div"]=s(n.VueDemi))})(this,function(n){"use strict";const s={canEdit:{type:Boolean,default:!0},limit:{type:Number,default:999999},content:{type:String,required:!0},renderHtml:{type:Boolean,default:!1},row:{type:Number,default:1},type:{type:String,default:"input"},autogrow:{type:Boolean,default:!1},wrapperClass:{type:String,default:"",required:!1}},h={resize:{resize:"vertical"},row:o=>({height:`${o}px`}),textarea:{overflowX:"hidden",overflowY:"auto"},autogrow:{height:"auto",whiteSpace:"wrap"},input:{overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap"},editableContainer:o=>({minHeight:`${o}px`,width:"180px",display:"block",padding:"5px 15px",lineHeight:"1.5",boxSizing:"border-box",fontSize:"inherit",color:"#606266",backgroundColor:"#ffffff",backgroundImage:"none",border:"1px solid #dcdfe6",borderRadius:"4px",transition:"border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1)"})};return n.defineComponent({name:"EditableDiv",props:s,emit:{"update:content":o=>{},focus:o=>{}},setup(o,{emit:l}){const r=n.ref(!1),d=n.ref(!1),u=n.ref(""),a=n.ref(),{resize:m,row:y,textarea:b,autogrow:g,input:v,editableContainer:C}=h,f=40,w=n.computed(()=>{const e={...C(f)};return o.type==="textarea"?(Object.assign(e,{...m,...y(f),...b}),o.autogrow&&Object.assign(e,{...g})):Object.assign(e,{...v}),e}),x=e=>{var i;const t=(i=a.value)==null?void 0:i.textContent;r.value||(S(),t.length>=o.limit?(e.preventDefault(),c(t)):(l("update:content",t),u.value=t))},S=()=>{var e;o.type==="input"&&(a.value.scrollLeft=(e=a.value)==null?void 0:e.scrollWidth)},E=e=>{const t=document.createRange();t.setStartAfter(e.lastChild),t.collapse(!1);const i=window.getSelection();i.removeAllRanges(),i.addRange(t),d.value=!0},T=e=>{e.type==="compositionstart"?r.value=!0:e.type==="compositionend"&&(r.value=!1)},c=e=>{let t;if(o.renderHtml){let i=document.createElement("div");i.style.display="none",i.innerHTML=e,t=i.innerText.slice(0,o.limit),a.value.innerHTML=e+"&nbsp;",i=null}else t=e.slice(0,o.limit),a.value.innerText=t;u.value=t,l("update:content",t),E(a.value)},z=()=>{d.value=!0,l("focus",!0)},B=()=>{d.value=!1,l("focus",!1)};return n.onMounted(()=>{n.nextTick(()=>{var e;(e=a.value)==null||e.addEventListener("paste",t=>{t.preventDefault();const i=t.clipboardData.getData("text/plain"),p=u.value+i;p.length>=o.limit?c(p):document.execCommand("insertText",!1,i)})})}),n.watch(()=>o.content,e=>{if(!d.value){if(r.value)return;c(e)}}),{...o,isVue3:n.isVue3,editorContainer:a,cssStyle:w,handleFocus:z,handleBlur:B,updateData:x,handleComposition:T}},render(){return n.h("div",this.isVue3?{ref:"editorContainer",style:{...this.cssStyle},class:this.wrapperClass,contentEditable:this.canEdit,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.updateData,onCompositionstart:this.handleComposition,onCompositionend:this.handleComposition}:{ref:"editorContainer",style:{...this.cssStyle},class:this.wrapperClass,attrs:{contentEditable:this.canEdit},on:{focus:this.handleFocus,blur:this.handleBlur,keyup:this.updateData,compositionstart:this.handleComposition,compositionend:this.handleComposition}})}})});
